{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mohamedelhedihaddar/weather-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mohamedelhedihaddar/weather-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mohamedelhedihaddar/weather-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState}from'react';import axios from'axios';import getCurrentForecast from'./helpers/getCurrentForecast';import getAlertForecast from'./helpers/getAlertForecast';import getHourlyForecast from'./helpers/getHourlyForecast';import getDailyForecast from'./helpers/getDailyForecast';import getDetailCurrentForecast from'./helpers/getDetailCurrentForecast';var API_KEY=\"b96cf2201d3a30a9889082d993d5610e\";var BASE_URL=\"https://api.openweathermap.org/data/2.5\";// const CROSS_URL = \"https://cors-anywhere.herokuapp.com\"\n// const REQUEST_URL = `${CROSS_URL}/${BASE_URL}`;\nvar useForecast=function useForecast(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isError=_useState2[0],setError=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),forecast=_useState6[0],setForecast=_useState6[1];var getCurrentLocationData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(location){var allData,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios(\"\".concat(BASE_URL,\"/weather?q=\").concat(location,\"&units=metric&lang=fr&appid=\").concat(API_KEY));case 3:allData=_context.sent;data=allData.data;return _context.abrupt(\"return\",{data:data});case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);return _context.abrupt(\"return\");case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function getCurrentLocationData(_x){return _ref.apply(this,arguments);};}();var getDetailLocationData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(lat,lon){var detailData,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios(\"\".concat(BASE_URL,\"/onecall?units=metric&lat=\").concat(lat,\"&lon=\").concat(lon,\"&lang=fr&exclude=minutely&appid=\").concat(API_KEY));case 3:detailData=_context2.sent;data=detailData;return _context2.abrupt(\"return\",{data:data});case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);return _context2.abrupt(\"return\");case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function getDetailLocationData(_x2,_x3){return _ref2.apply(this,arguments);};}();var getLocationBase=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(location){var cityData,current_data,Location_lat,Location_lon,cityDetails,dataObject;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return getCurrentLocationData(location);case 3:cityData=_context3.sent;current_data=cityData.data;Location_lat=cityData.data.coord.lat;Location_lon=cityData.data.coord.lon;_context3.prev=7;_context3.next=10;return getDetailLocationData(Location_lat,Location_lon);case 10:cityDetails=_context3.sent;dataObject={current_data:current_data,cityDetails:cityDetails.data.data};return _context3.abrupt(\"return\",dataObject);case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](7);return _context3.abrupt(\"return\");case 18:_context3.next=23;break;case 20:_context3.prev=20;_context3.t1=_context3[\"catch\"](0);return _context3.abrupt(\"return\");case 23:case\"end\":return _context3.stop();}}},_callee3,null,[[0,20],[7,15]]);}));return function getLocationBase(_x4){return _ref3.apply(this,arguments);};}();var deployData=function deployData(data){var currentForecast=getCurrentForecast(data.current_data);var hourlyForecast=getHourlyForecast(data.cityDetails.hourly);var daylyForecast=getDailyForecast(data.cityDetails.daily);var alertsForecast=getAlertForecast(data.cityDetails.alerts);var detailCurrentForecast=getDetailCurrentForecast(data.cityDetails.daily[0]);setForecast({currentForecast:currentForecast,hourlyForecast:hourlyForecast,daylyForecast:daylyForecast,alertsForecast:alertsForecast,detailCurrentForecast:detailCurrentForecast});setLoading(false);};// on submit location recup DATA\nvar submitRequest=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(location){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setLoading(true);setError(false);_context4.prev=2;_context4.next=5;return getLocationBase(location);case 5:response=_context4.sent;deployData(response);_context4.next=14;break;case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](2);setError(true);setLoading(false);return _context4.abrupt(\"return\");case 14:case\"end\":return _context4.stop();}}},_callee4,null,[[2,9]]);}));return function submitRequest(_x5){return _ref4.apply(this,arguments);};}();return{isError:isError,isLoading:isLoading,forecast:forecast,submitRequest:submitRequest};};export default useForecast;","map":{"version":3,"sources":["/Users/mohamedelhedihaddar/weather-app/src/useForecast.js"],"names":["useState","axios","getCurrentForecast","getAlertForecast","getHourlyForecast","getDailyForecast","getDetailCurrentForecast","API_KEY","BASE_URL","useForecast","isError","setError","isLoading","setLoading","forecast","setForecast","getCurrentLocationData","location","allData","data","getDetailLocationData","lat","lon","detailData","getLocationBase","cityData","current_data","Location_lat","coord","Location_lon","cityDetails","dataObject","deployData","currentForecast","hourlyForecast","hourly","daylyForecast","daily","alertsForecast","alerts","detailCurrentForecast","submitRequest","response"],"mappings":"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","sourcesContent":["import {useState} from 'react'\nimport axios from 'axios';\nimport getCurrentForecast from './helpers/getCurrentForecast';\nimport getAlertForecast from './helpers/getAlertForecast';\nimport getHourlyForecast from './helpers/getHourlyForecast';\nimport getDailyForecast from './helpers/getDailyForecast';\nimport getDetailCurrentForecast from './helpers/getDetailCurrentForecast';\n\nconst API_KEY = \"b96cf2201d3a30a9889082d993d5610e\";\nconst BASE_URL = \"https://api.openweathermap.org/data/2.5\"\n// const CROSS_URL = \"https://cors-anywhere.herokuapp.com\"\n// const REQUEST_URL = `${CROSS_URL}/${BASE_URL}`;\n\n\nconst useForecast = () => {\n\n    const [isError, setError] = useState(false);\n    const [isLoading, setLoading] = useState(false);\n    const [forecast, setForecast] = useState(null);\n    \n    const getCurrentLocationData = async (location) =>{\n        try {\n            const allData = await axios(`${BASE_URL}/weather?q=${location}&units=metric&lang=fr&appid=${API_KEY}`);\n            \n            const data = allData.data;\n            return {data};\n        } catch (error) {\n            return; \n        }       \n    }\n\n    const getDetailLocationData = async (lat,lon) =>{\n        try {\n            const detailData = await axios(`${BASE_URL}/onecall?units=metric&lat=${lat}&lon=${lon}&lang=fr&exclude=minutely&appid=${API_KEY}`);\n\n            const data = detailData;\n        return {data};\n        } catch (error) {\n            return;\n        }\n    }\n\n    const getLocationBase = async (location) => {\n        try {\n            const cityData = await getCurrentLocationData(location); \n\n            const current_data = cityData.data;\n            const Location_lat = cityData.data.coord.lat;\n            const Location_lon = cityData.data.coord.lon;\n            try {\n                const cityDetails= await getDetailLocationData(Location_lat,Location_lon);\n                \n                const dataObject = {current_data : current_data, cityDetails : cityDetails.data.data};\n                return dataObject;\n            } catch (error) {\n                return;\n            }\n        } catch (error) {\n            return; \n        }\n    }\n\n    const deployData = (data) =>{\n        \n        const currentForecast = getCurrentForecast(data.current_data);\n        const hourlyForecast = getHourlyForecast(data.cityDetails.hourly);\n        const daylyForecast = getDailyForecast(data.cityDetails.daily);\n        const alertsForecast = getAlertForecast(data.cityDetails.alerts);\n        const detailCurrentForecast = getDetailCurrentForecast(data.cityDetails.daily[0]);\n\n        setForecast({\n            currentForecast,\n            hourlyForecast,\n            daylyForecast,\n            alertsForecast,\n            detailCurrentForecast\n        });\n        setLoading(false);\n    }\n\n    // on submit location recup DATA\n    const submitRequest = async location =>{\n        setLoading(true);\n        setError(false);\n        try {\n            const response = await getLocationBase(location);\n            deployData(response);\n        } catch (error) {\n            setError(true);\n            setLoading(false);\n            return;\n        }      \n    }\n\n      return {\n        isError,\n        isLoading,\n        forecast,\n        submitRequest\n    }\n}\n\nexport default useForecast\n"]},"metadata":{},"sourceType":"module"}